---
layout: post
title: mysql
category: 面试
tags: 
description:
---

# 八、sql语句

## 优化

### 1.语法上
- 少用多表连接,要用的话先用where语句筛选
- 合理的使用索引,避免全表扫描
(1)最左前缀匹配原则

(2)索引不能参与计算

(3)尽量扩展索引

(4)OR 语句前后没有同时使用索引

# 九、表结构
- MyISAM 支持表级锁。适用于选择密集型和插入密集型的表

- 支持事务，行级锁，外键，聚集索引适用于更新密集的表，容灾性也较好。

# 十、读写分离原理
两个线程(Sql线程和IO线程)在 Slave 端，另外一个线程(IO线程)在 Master 端。

![读写分离]({{site.url}}/assets/image/interview/3.png)

- 在每个事务更新数据完成之前，master在二进制日志记录这些改变。写入二进制日志完成后，master通知存储引擎提交事务。

- Slave将master的binary log复制到其中继日志。首先slave开始一个工作线程（I/O），I/O线程在master上打开一个普通的连接，然后开始binlog dump process。binlog dump process从master的二进制日志中读取事件，如果已经跟上master，它会睡眠并等待master产生新的事件，I/O线程将这些事件写入中继日志。

- Sql slave thread（sql从线程）处理该过程的最后一步，sql线程从中继日志读取事件，并重放其中的事件而更新slave数据，使其与master中的数据一致，只要该线程与I/O线程保持一致，中继日志通常会位于os缓存中，所以中继日志的开销很小。

# 十一、B树

## B树
- 将相关数据尽量集中在一起，以便一次读取多个数据，减少硬盘操作次数。
子节点的值和根节点有严格对应的大小需求

- 子节点的值和根节点有严格对应的大小需求

- 分裂是把该节点中间的关键字取到父节点,两边分裂为同级子节点
![B树]({{site.url}}/assets/image/interview/4.png)

## B+树

- B+ 树元素自底向上插入
- 一个节点可以容纳多个值,只有叶子节点才记录数据，非叶子节点只包含索引
- 从根节点起随机查找（起点是指向根节点的root）； 二，顺序查找（起点是指向最小关键字的sqt）。
- 子节点的值和父节点的值有严格大小对应关系,如果某节点有a个值,那么有a + 1个子节点,假如节点内有啊a,b个值
那么第一个子节点< a,第二在ab之间,第三个比b大
- m阶越多,可存的值越多s

![B+树]({{site.url}}/assets/image/interview/5.jpg)